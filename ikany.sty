 %   If a command has defined, then
 %     New     : error
 %     Renew   : define
 %     Declare : define
 %     Provide : not define
 %   If a command has "not" defined, then
 %     New     : define
 %     Renew   : error
 %     Declare : define
 %     Provide : define

 %   \let\foo\bar             -> copy the value of \bar and paste to \foo
 %   \def\foo{\bar}           -> consider \foo as an alternative command of \bar
 %   \newcommand\foo{\bar}    -> basically sam with \def but (1) check if defined, (2) can get optional arguments
 
 %   Argument specification in xparse package
 %   m:            {mandatory}
 %   r[]:          [mandatory]
 %   g:            {optional}
 %   o:            [optional]
 %   O{default}:   [optional with default]
 %   d():          (optional)
 %   D<>{default}: <optional with default>
 %   s:            star -> \IfBooleanTF{#?}{starred}{unstarred}
 %   +m:           {mandatory, which can be a sentence}
 
 
 
\NeedsTeXFormat{LaTeX2e}[1994/06/01]
\ProvidesPackage{ikany}[2018/10/29 ikany]
\makeatletter
\RequirePackage{amsfonts,amsmath,amssymb}
%\RequirePackage[many]{tcolorbox}





%///////////////////////%
%  Theorems and Proofs  %
%///////////////////////%
%
% Example Code:
%	\begin{ex}
%	This is an example.
%	\end{ex}
%	\begin{pf}[2]    % second proof
%	\Case[1] Easy.
%	\Case[2]{When $p=2$.} Not easy.
%	\end{pf}
%
\RequirePackage{amsthm,xparse}
\theoremstyle{plain}
  \newtheorem{thm}{Theorem}[section]
  \newtheorem*{thm*}{Theorem}
  \newtheorem{prop}[thm]{Proposition}
  \newtheorem*{prop*}{Proposition}
  \newtheorem{cor}[thm]{Corollary}
  \newtheorem{lem}[thm]{Lemma}
\theoremstyle{definition}
  \newtheorem{defn}{Definition}[section]
  \newtheorem{ex}[thm]{Example}
  \newtheorem{prb}{Problem}[section]
\theoremstyle{remark}
  \newtheorem*{rmk}{Remark}

\newenvironment{pf}[1][\unskip]{\begin{proof}[Proof #1]}{\end{proof}}
\newenvironment{sol}[1][\unskip]{\begin{proof}[Solution #1]}{\end{proof}}
\newenvironment{note}[1][\unskip]{\begin{proof}[Note #1]\renewcommand{\qedsymbol}{}}{\end{proof}}
\newenvironment{idea}[1][\unskip]{\begin{proof}[Proof idea #1]\renewcommand{\qedsymbol}{}}{\end{proof}}
\NewDocumentCommand{\Case}{r[]+g}{\IfNoValueTF{#2}{\emph{Case #1.}}{\emph{Case #1: #2.}}}
\NewDocumentCommand{\Step}{r[]+g}{\IfNoValueTF{#2}{\emph{Step #1.}}{\emph{Step #1: #2.}}}

\ifx\thisisprbcls\undefined\else
  \renewcommand{\theprb}{\arabic{section}.\arabic{prb}}
  \renewenvironment{sol}[1][\unskip]{\noindent\begin{proof}[Solution]\ \par\begin{cond}}{\end{cond}\end{proof}} % line break
\fi





%/////////////////////%
%  List environments  %
%/////////////////////%
%
% Example Code:
%	\begin{exer}
%	\item  easy problem
%	\item* hard problem
%	\begin{exer}
%	\item subproblem
%	\end{exer}
%	\end{exer}
%
\RequirePackage{enumitem}
\newlist{cond}{enumerate}{1}
  \setlist[cond,1]{label=\rm{(\arabic*)}}
\newlist{exer}{enumerate}{2}
  \setlist[exer,1]{label=\arabic*.,before={\large Exercises}}
  \setlist[exer,2]{label=(\alph*)}
\let\@@item\item
\newcommand{\sitem}{\refstepcounter{\@enumctr}\@@item[$^*$\csname label\@enumctr\endcsname]}
\renewcommand*{\item}{\@ifstar\sitem\@@item}





%////////////////////////%
%  Commutative diagrams  %
%////////////////////////%
%
% Example Code:
%	\begin{es}  0  \>  A  \mn  B  \ep  C  \>  0  \end{es}
%
%	\begin{cd}[row sep={24pt,between origins}, column sep={36pt,between origins}]
%	A  \ds{rd}{\exists !} \lar{rrd} \rar{ddr}  &                           &     \\
%	                                           &  X\times Y  \ar{r}\ar{d}  &  X  \\
%	                                           &  Y                        &
%	\end{cd}
%
\RequirePackage{tikz-cd,xparse}
\NewDocumentEnvironment{cd}{}
  {
    \renewcommand{\mn}{\ar[tail]}
    \renewcommand{\ep}{\ar[two heads]}
    \[\begin{tikzcd}
  }
  {\end{tikzcd}\]}
\NewDocumentEnvironment{es}{}
  {
    \renewcommand{\>}{\ar{r}\&}
    \renewcommand{\mn}{\ar[tail]}
    \renewcommand{\ep}{\ar[two heads]}
    \tikzcdset{column sep=small,ampersand replacement=\&}
    \[\begin{tikzcd}
  }
  {\end{tikzcd}\]}
\NewDocumentEnvironment{rd}{}
  {
    \tikzcdset{math mode=false,labels={font=\scriptsize}}
    \[\begin{tikzcd}
  }
  {\end{tikzcd}\]}
  
\newcommand{\block}[1]{\begin{tabular}{c}#1\end{tabular}}
\def\lar{\ar[bend left]}
\def\rar{\ar[bend right,swap]}
\def\ds{\ar[dashed]}
\def\lds{\ar[dashed,bend left]}
\def\rds{\ar[dashed,bend right,swap]}
\def\hk{\ar[hook]}





%//////////////////////////%
%  Differential operators  %
%//////////////////////////%
%
% Example Code:
%	\pd
%	\pd{x}
%	\pd[2]{x}
%	\pd[2]{f}{x}
%	\pd{f}{x}{y}
%	\frac{\pd^3 f}{\pd x^2\pd y}
%
\RequirePackage{xparse}
\NewDocumentCommand{\pd}{oggg}{
  \IfNoValueTF{#2}
  {\partial \IfNoValueTF{#1}{}{^{#1}}}
  {
    \IfNoValueTF{#3}
    {\frac{\partial\IfNoValueTF{#1}{}{^{#1}}}{\partial#2\IfNoValueTF{#1}{}{^{#1}}}}
    {
      \IfNoValueTF{#4}
      {\frac{\partial\IfNoValueTF{#1}{}{^{#1}}#2}{\partial#3\IfNoValueTF{#1}{}{^{#1}}}}
      {\frac{\partial^2#2}{\partial#3\,\partial#4}}
    }
  }
}
\NewDocumentCommand{\dd}{oggg}{
  \IfNoValueTF{#3}
  {\frac{d\IfNoValueTF{#1}{}{^{#1}}}{d#2\IfNoValueTF{#1}{}{^{#1}}}}
  {
    \IfNoValueTF{#4}
    {\frac{d\IfNoValueTF{#1}{}{^{#1}}#2}{d#3\IfNoValueTF{#1}{}{^{#1}}}}
    {\frac{d^2#2}{d#3\,d#4}}
  }
}
\newcommand\del{\nabla} % del
\DeclareMathOperator{\grad}{grad}
\DeclareMathOperator{\curl}{curl}
\let\division\div
\let\div\relax
\DeclareMathOperator{\div}{div}





%///////////////////////%
%  System of equations  %
%///////////////////////%
%
% Example Code:
%	\begin{pde*}{\label{eq:heat}}
%	\pd_tu-\Delta u &= 0,  \: \p{in} \R_x\x\R_t,\\
%	      u(x,0) &= f(x),  \:
%	\end{pde*}
%
\RequirePackage{xparse}
\NewDocumentEnvironment{pde}{s} % number it as a single equation
{
  \renewcommand\:{&\qquad&}
  \[\left\{
  \begin{alignedat}{2}
}
{
  \IfBooleanTF{#1}
    {\end{alignedat}\right.\]}
    {\end{alignedat}\right.\stepcounter{equation}\tag{\theequation}\]}
}
\ExplSyntaxOn
\cs_new:cpn{pde*}{\pde*}
\cs_new_eq:cN{endpde*}\endpde
\ExplSyntaxOff

% align이나 alignat이 environment에 들어가서 \end{pdes}를 뺏어버렸다.... 언제 고치지
\NewDocumentEnvironment{pdes}{}
{
  \begin{subequations}
  \begin{alignat}{2}
}
{
  \end{alignat}
  \end{subequations}
}

\NewDocumentEnvironment{de}{s} % number it as a single equation
{
  \renewcommand\:{&\qquad&}
  \IfBooleanTF{#1}
    {\alignat{2}}
    {\alignat*{2}}
}
{
  \IfBooleanTF{#1}
    {\endalignat}
    {\endalignat*}
}




%////////////////////%
%  Matrix shortcuts  %
%////////////////////%
%
% Example Code
%	\mat{1&0//0&1}
%	\mat[v]{1&0//0&1}  % determinant
%
\newcommand{\mat}[2][p]{%
  \begin{#1matrix}#2\end{#1matrix}
}
% option:p,b,B,v,V






%/////////////////////////////////////%
%  Parentheses, Braces, and Brackets  %
%/////////////////////////////////////%

\let\<\langle
\let\>\rangle  % overlapped

\RequirePackage{xparse}
\DeclareDocumentCommand{\abs}{m}{\left\lvert#1\right\rvert}
\DeclareDocumentCommand{\norm}{m}{\left\lVert#1\right\rVert}
\DeclareDocumentCommand{\flr}{m}{\left\lfloor#1\right\rfloor}
\DeclareDocumentCommand{\ceil}{m}{\left\lceil#1\right\rceil}
\DeclareDocumentCommand{\inn}{mg}{\IfNoValueTF{#2}{\left\langle#1\right\rangle}{\left\langle#1,#2\right\rangle}}





%////////////////////////////%
%  Shorthands for Notations  %
%////////////////////////////%
%
% Example Code
%
%	f(x)=0 \p{for all} x\in\R 
%	f(x)=0 \c{and} g(x)=0
%
%	\evalat{f(x)}{x=0}
%	\evalat{f(x)}{x=a}{x=b}
%
% Binary operators
\def\.{\cdot} % dot product
\def\o{\circ} % function composition
\def\x{\times} % cross product
\def\dsum{\oplus} % direct sum
\def\tn{\otimes} % tensor product
\def\wdg{\wedge} % wedge
\def\smsh{\vee} % smash product

% Big operators
\def\bigdsum{\bigoplus}
\def\bigtn{\bigotimes}

% Texts - prepositions and conjunctions
\def\cc{\c c} % french c
\def\cC{\c C} % french C
\renewcommand\c[1]{\quad\text{#1}\quad}
\newcommand\p[1]{\enspace\text{#1}\enspace}
\newcommand\st{\p{s.t.}}

% Arrows
\let\@@to\to
\RenewDocumentCommand{\to}{g}{\IfNoValueTF{#1}{\@@to}{\overset{#1}{\@@to}}}
\def\emb{\hookrightarrow}
\def\mn{\rightarrowtail}
\def\ep{\twoheadrightarrow}
\def\acts{\curvearrowright}

% Relations
\def\les{\lesssim}
\def\hmtp{\simeq}
\def\isom{\cong}

% Diacritics
\def\cl{\overline} % bar (closure)
\def\conj{\overline}
\let\hat\widehat % hat
\let\tld\widetilde % tilde

% Standalone notations
\def\bul{\bullet} % bullet
\def\oo{\infty} % infinity
\def\mt{\varnothing} % emptyset
\def\bd{\partial} % boundary
\def\1{\bold{1}} % characteristic function

% 기타
\let\bigmath\displaystyle
\def\cat{\mathbf}
\def\impl{\mathchoice{\quad\Longrightarrow\quad}{\,\Rightarrow\,}{\,\Rightarrow\,}{\,\Rightarrow\,}}
\renewcommand{\iff}{\mathchoice{\quad\Longleftrightarrow\quad}{\,\Leftrightarrow\,}{\,\Leftrightarrow\,}{\,\Leftrightarrow\,}}
\NewDocumentCommand{\evalat}{mmg}{\left.#1\right\rvert_{#2}\IfNoValueTF{}{^{#3}}}





%////////////////////////////%
%  Shorthands for Alphabets  %
%////////////////////////////%

% Some greeks
\def\e{\varepsilon}
\def\f{\varphi}

% Blackboard fonts
\def\A{\mathbb{A}}
\def\B{\mathbb{B}}
\def\C{\mathbb{C}}
\def\E{\mathbb{E}}
\def\F{\mathbb{F}}
\def\G{\mathbb{G}}
\def\H{\mathbb{H}}
\def\N{\mathbb{N}}
\def\P{\mathbb{P}}
\def\Q{\mathbb{Q}}
\def\R{\mathbb{R}}
\def\T{\mathbb{T}}
\def\Z{\mathbb{Z}}

% Bold fonts
\def\bA{\mathbf{A}}
\def\bB{\mathbf{B}}
\def\bC{\mathbf{C}}
\def\bD{\mathbf{D}}
\def\bE{\mathbf{E}}
\def\bF{\mathbf{F}}
\def\bG{\mathbf{G}}
\def\bH{\mathbf{H}}
\def\bI{\mathbf{I}}
\def\bJ{\mathbf{J}}
\def\bK{\mathbf{K}}
\def\bL{\mathbf{L}}
\def\bM{\mathbf{M}}
\def\bN{\mathbf{N}}
\def\bO{\mathbf{O}}
\def\bP{\mathbf{P}}
\def\bQ{\mathbf{Z}}
\def\bR{\mathbf{R}}
\def\bS{\mathbf{S}}
\def\bT{\mathbf{T}}
\def\bU{\mathbf{U}}
\def\bV{\mathbf{V}}
\def\bW{\mathbf{W}}
\def\bX{\mathbf{X}}
\def\bY{\mathbf{Y}}
\def\bZ{\mathbf{Z}}

% Caligraphy fonts
\def\cA{\mathcal{A}}
\def\cB{\mathcal{B}}
\def\cC{\mathcal{C}}
\def\cD{\mathcal{D}}
\def\cE{\mathcal{E}}
\def\cF{\mathcal{F}}
\def\cG{\mathcal{G}}
\def\cH{\mathcal{H}}
\def\cI{\mathcal{I}}
\def\cJ{\mathcal{J}}
\def\cK{\mathcal{K}}
\def\cL{\mathcal{L}}
\def\cM{\mathcal{M}}
\def\cN{\mathcal{N}}
\def\cO{\mathcal{O}}
\def\cP{\mathcal{P}}
\def\cQ{\mathcal{Q}}
\def\cR{\mathcal{R}}
\def\cS{\mathcal{S}}
\def\cT{\mathcal{T}}
\def\cU{\mathcal{U}}
\def\cV{\mathcal{V}}
\def\cW{\mathcal{W}}
\def\cX{\mathcal{X}}
\def\cY{\mathcal{Y}}
\def\cZ{\mathcal{Z}}

% Fraktur fonts
\def\fA{\mathfrak{A}}
\def\fB{\mathfrak{B}}
\def\fC{\mathfrak{C}}
\def\fD{\mathfrak{D}}
\def\fE{\mathfrak{E}}
\def\fF{\mathfrak{F}}
\def\fG{\mathfrak{G}}
\def\fH{\mathfrak{H}}
\def\fI{\mathfrak{I}}
\def\fJ{\mathfrak{J}}
\def\fK{\mathfrak{K}}
\def\fL{\mathfrak{L}}
\def\fM{\mathfrak{M}}
\def\fN{\mathfrak{N}}
\def\fO{\mathfrak{O}}
\def\fP{\mathfrak{P}}
\def\fQ{\mathfrak{Q}}
\def\fR{\mathfrak{R}}
\def\fS{\mathfrak{S}}
\def\fT{\mathfrak{T}}
\def\fU{\mathfrak{U}}
\def\fV{\mathfrak{V}}
\def\fW{\mathfrak{W}}
\def\fX{\mathfrak{X}}
\def\fY{\mathfrak{Y}}
\def\fZ{\mathfrak{Z}}
\def\fa{\mathfrak{a}}
\def\fb{\mathfrak{b}}
\def\fc{\mathfrak{c}}
\def\ff{\mathfrak{f}}
\def\fg{\mathfrak{g}}
\def\fh{\mathfrak{h}}
\def\fm{\mathfrak{m}}
\def\fp{\mathfrak{p}}
\def\fq{\mathfrak{q}}
\def\fu{\mathfrak{u}}

% Lie theory
\def\fgl{\mathfrak{gl}}
\def\fsl{\mathfrak{sl}}
\def\fso{\mathfrak{so}}
\def\fsu{\mathfrak{su}}

\newcommand{\GL}{\mathrm{GL}}
\newcommand{\OO}{\mathrm{O}}
\newcommand{\UU}{\mathrm{U}}           % \U : collide with beamer, hyperref
\newcommand{\SL}{\mathrm{SL}}
\newcommand{\SO}{\mathrm{SO}}
\newcommand{\SU}{\mathrm{SU}}
\newcommand{\PGL}{\mathrm{PGL}}
\newcommand{\PSL}{\mathrm{PSL}}
\newcommand{\PSO}{\mathrm{PSO}}
\newcommand{\PSU}{\mathrm{PSU}}
\newcommand{\Sp}{\mathrm{Sp}}
\newcommand{\Spin}{\mathrm{Spin}}
\newcommand{\Mat}{\mathrm{Mat}}

% Miscellany
\let\Re\relax
\let\Im\relax
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\Ad}{Ad}
\DeclareMathOperator{\adj}{adj}
\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Ban}{Ban}
\DeclareMathOperator{\Char}{char}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator*{\colim}{colim}
\DeclareMathOperator{\conv}{conv}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\disc}{disc}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator*{\esssup}{ess\,sup}
\DeclareMathOperator{\eval}{eval}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Fix}{Fix}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\Hess}{Hess}
\DeclareMathOperator{\Hol}{Hol}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\Im}{Im}
\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\Lip}{Lip}
\DeclareMathOperator{\Orb}{Orb}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\pv}{p.v.}
\DeclareMathOperator{\Re}{Re}
\DeclareMathOperator{\rel}{rel}
\DeclareMathOperator*{\res}{res}
\DeclareMathOperator{\rk}{rk}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\spn}{span}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\Syl}{Syl}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\vol}{vol}
\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\Tr}{Tr}

\makeatother

\endinput